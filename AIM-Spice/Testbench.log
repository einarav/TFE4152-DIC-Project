
*************************************************************************************

              AIM-Spice Version 2020.100  (Built on Aug 27 2020)

*************************************************************************************

	Date: Tue Nov  3 12:39:05 2020
	Circuit File: Testbench.cir

*******************************  Circuit Description  *******************************

     1:  * This is a parametrized testbench for your pixel circuit array
     2:  
     3:  * You should at least test your circuit with:
     4:  *	- current of 50 pA and exposure time 30 ms
     5:  *	- current of 750 pA and exposure time 2 ms
     6:  
     7:  * Instructions
     8:  * Connect EXPOSE, ERASE, NRE_R1 and NRE_R2 at the right place
     9:  * Run a transient simulation with length 60 ms
    10:  * Make sure outputs of pixel circuits to ADC are called OUT1 and OUT2
    11:  * Make plots of output voltages to ADC (here called OUT1 and OUT2)
    12:  * The voltage across internal capacitor (any pixel) is also of interest (here called OUT_SAMPLED1)
    13:  * You should also plot the control signals EXPOSE, NRE_R1, NRE_R2 and ERASE
    14:  
    15:  !!!!!!!!!!!!!!!!!!!!!!
    16:  !!!!! PARAMETERS !!!!!
    17:  !!!!!!!!!!!!!!!!!!!!!!
    18:  .param Ipd_11       = 750p  ! Photodiode current, range [50 pA, 750 pA]
    19:  .param Ipd_12       = 500p  ! Photodiode current, range [50 pA, 750 pA]
    20:  .param Ipd_21       = 250p  ! Photodiode current, range [50 pA, 750 pA]
    21:  .param Ipd_22       = 50p   ! Photodiode current, range [50 pA, 750 pA]
    22:  .param VDD          = 1.8   ! Supply voltage
    23:  .param EXPOSURETIME = 2m    ! Exposure time, range [2 ms, 30 ms]
    24:  
    25:  ! Automaticly calculate all the other parameters 
    26:  .param TRF          = {EXPOSURETIME/100}             ! Risetime and falltime of EXPOSURE and ERASE signals
    27:  .param PW           = {EXPOSURETIME}                 ! Pulsewidth of EXPOSURE and ERASE signals
    28:  .param PERIOD       = {EXPOSURETIME*10}              ! Period for testbench sources
    29:  .param FS           = 1k;                            ! Sampling clock frequency 
    30:  .param CLK_PERIOD   = {1/FS}                         ! Sampling clock period
    31:  .param EXPOSE_DLY   = {CLK_PERIOD}                   ! Delay for EXPOSE signal
    32:  .param NRE_R1_DLY   = {2*CLK_PERIOD + EXPOSURETIME}  ! Delay for NRE_R1 signal
    33:  .param NRE_R2_DLY   = {4*CLK_PERIOD + EXPOSURETIME}  ! Delay for NRE_R2 signal
    34:  .param ERASE_DLY    = {6*CLK_PERIOD + EXPOSURETIME}  ! Delay for ERASE signal
    35:  .param SIM_TIME     = {10*CLK_PERIOD + EXPOSURETIME} ! Delay for ERASE signal
    36:  
    37:  
    38:  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    39:  !!!!! Supplies and pulse generation !!!!!
    40:  !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    41:  VDD     1       0 dc VDD                                                            ! General supply
    42:  VEXPOSE EXPOSE  0 dc 0  PULSE(0     VDD  EXPOSE_DLY  TRF TRF EXPOSURETIME PERIOD)   ! Expose pulse, active high
    43:  VERASE  ERASE   0 dc 0  PULSE(0     VDD  ERASE_DLY   TRF TRF CLK_PERIOD   PERIOD)   ! Erase pulse, active high
    44:  VNRE_R1 NRE_R1  0 dc 0  PULSE(VDD   0    NRE_R1_DLY  TRF TRF CLK_PERIOD   PERIOD)   ! NRE_R1 Pulse, active low
    45:  VNRE_R2 NRE_R2  0 dc 0  PULSE(VDD   0    NRE_R2_DLY  TRF TRF CLK_PERIOD   PERIOD)   ! NRE_R2 Pulse, active low
    46:  
    47:  
    48:  !!!!!!!!!!!!!!!!!!!!
    49:  !!!!! Includes !!!!!
    50:  !!!!!!!!!!!!!!!!!!!!
    51:  
    52:  ! Photodiode
    53:  *include ./photodiode.cir
    54:  .subckt PhotoDiode  VDD N1_R1C1 PARAM: Ipd=750p
    55:  I1_R1C1  VDD   N1_R1C1   DC  {Ipd}              ! Photo current source
    56:  d1 N1_R1C1 VDD dwell 1                        ! Reverse biased Diode
    57:  .model dwell d cj0=1e-14 is=1e-12 m=0.5 bv=40 ! Diode model
    58:  Cd1 N1_R1C1 VDD 30f                           ! Photo diode capacitor
    59:  .ends
    60:  *end of: ./photodiode.cir
    61:  ! Transistors
    62:  *include ./p18_model_card.inc
    63:  * p18 model card
    64:  .MODEL NMOS NMOS  								
    65:  + VERSION	=	3.1						
    66:  + LEVEL	=	49	NOIMOD	=	1	TNOM	=	2.70E+01
    67:  + TOX	=	'4.1E-9/proc_delta'	XJ	=	1.00E-07	NCH	=	2.33E+17
    68:  + VTH0	=	'0.36+vt_shift'	K1	=	5.84E-01	K2	=	4.14E-03
    69:  + K3	=	1.01E-03	K3B	=	2.20E+00	W0	=	1.00E-07
    70:  + NLX	=	1.81E-07	DVT0W	=	0.00E+00	DVT1W	=	0.00E+00
    71:  + DVT2W	=	0.00E+00	DVT0	=	1.73E+00	DVT1	=	4.38E-01
    72:  + DVT2	=	-3.70E-04	U0	=	'260*proc_delta*proc_delta'	UA	=	-1.38E-09
    73:  + UB	=	2.26E-18	UC	=	5.46E-11	VSAT	=	1.03E+05
    74:  + A0	=	1.92E+00	AGS	=	4.20E-01	B0	=	-1.52E-09
    75:  + B1	=	-9.92E-08	KETA	=	-7.16E-03	A1	=	6.61E-04
    76:  + A2	=	8.89E-01	RDSW	=	1.12E+02	PRWG	=	4.92E-01
    77:  + PRWB	=	-2.02E-01	WR	=	1.00E+00	WINT	=	7.12E-09
    78:  + LINT	=	1.12E-08	XL	=	-2.00E-08	XW	=	-1.00E-08
    79:  + DWG	=	-3.82E-09	DWB	=	8.63E-09	VOFF	=	-8.82E-02
    80:  + NFACTOR	=	2.30E+00	CIT	=	0.00E+00	CDSC	=	2.40E-04
    81:  + CDSCD	=	0.00E+00	CDSCB	=	0.00E+00	ETA0	=	3.13E-03
    82:  + ETAB	=	1.00E+00	DSUB	=	2.25E-02	PCLM	=	7.20E-01
    83:  + PDIBLC1	=	2.15E-01	PDIBLC2	=	2.23E-03	PDIBLCB	=	1.00E-01
    84:  + DROUT	=	8.01E-01	PSCBE1	=	5.44E+08	PSCBE2	=	1.00E-03
    85:  + PVAG	=	1.00E-12	DELTA	=	1.00E-02	RSH	=	6.78E+00
    86:  + MOBMOD	=	1.00E+00	PRT	=	0.00E+00	UTE	=	-1.50E+00
    87:  + KT1	=	-1.10E-01	KT1L	=	0.00E+00	KT2	=	2.19E-02
    88:  + UA1	=	4.28E-09	UB1	=	-7.62E-18	UC1	=	-5.57E-11
    89:  + AT	=	3.30E+04	WL	=	0.00E+00	WLN	=	1.00E+00
    90:  + WW	=	0.00E+00	WWN	=	1.00E+00	WWL	=	0.00E+00
    91:  + LL	=	0.00E+00	LLN	=	1.00E+00	LW	=	0.00E+00
    92:  + LWN	=	1.00E+00	LWL	=	0.00E+00	CAPMOD	=	2.00E+00
    93:  + XPART	=	5.00E-01	CGDO	=	6.98E-10	CGSO	=	7.03E-10
    94:  + CGBO	=	1.00E-12	CJ	=	'9.8e-4/proc_delta'	PB	=	7.34E-01
    95:  + MJ	=	3.63E-01	CJSW	=	'2.4e-10/proc_delta'	PBSW	=	4.71E-01
    96:  + MJSW	=	1.00E-01	CJSWG	=	3.29E-10	PBSWG	=	4.66E-01
    97:  + MJSWG	=	1.00E-01	CF	=	0.00E+00	PVTH0	=	-7.16E-04
    98:  + PRDSW	=	-6.66E-01	PK2	=	5.92E-04	WKETA	=	2.14E-04
    99:  + LKETA	=	-1.51E-02	PU0	=	3.36E+00	PUA	=	-1.31E-11
   100:  + PUB	=	0.00E+00	PVSAT	=	1.25E+03	PETA0	=	1.00E-04
   101:  + PKETA	=	6.45E-04	KF	=	4.46E-29			
   102:  								
   103:  .MODEL PMOS PMOS  								
   104:  + VERSION	=	3.1						
   105:  + LEVEL	=	49	NOIMOD	=	1			
   106:  + TNOM	=	2.70E+01	TOX	=	'4.1E-9/proc_delta'	XJ	=	1.00E-07
   107:  + NCH	=	4.12E+17	VTH0	=	'-0.39-vt_shift'	K1	=	5.50E-01
   108:  + K2	=	3.50E-02	K3	=	0.00E+00	K3B	=	1.20E+01
   109:  + W0	=	1.00E-06	NLX	=	1.25E-07	DVT0W	=	0.00E+00
   110:  + DVT1W	=	0.00E+00	DVT2W	=	0.00E+00	DVT0	=	5.53E-01
   111:  + DVT1	=	2.46E-01	DVT2	=	1.00E-01	U0	=	'110*proc_delta*proc_delta'
   112:  + UA	=	1.44E-09	UB	=	2.29E-21	UC	=	-1.00E-10
   113:  + VSAT	=	1.95E+05	A0	=	1.72E+00	AGS	=	3.80E-01
   114:  + B0	=	5.87E-07	B1	=	1.44E-06	KETA	=	2.21E-02
   115:  + A1	=	4.66E-01	A2	=	3.00E-01	RDSW	=	3.11E+02
   116:  + PRWG	=	5.00E-01	PRWB	=	1.64E-02	WR	=	1.00E+00
   117:  + WINT	=	0.00E+00	LINT	=	2.00E-08	XL	=	-2.00E-08
   118:  + XW	=	-1.00E-08	DWG	=	-3.49E-08	DWB	=	1.22E-09
   119:  + VOFF	=	-9.80E-02	NFACTOR	=	2.00E+00	CIT	=	0.00E+00
   120:  + CDSC	=	2.40E-04	CDSCD	=	0.00E+00	CDSCB	=	0.00E+00
   121:  + ETA0	=	1.12E-03	ETAB	=	-4.79E-04	DSUB	=	1.60E-03
   122:  + PCLM	=	1.50E+00	PDIBLC1	=	3.00E-02	PDIBLC2	=	-1.01E-05
   123:  + PDIBLCB	=	1.00E-01	DROUT	=	1.56E-03	PSCBE1	=	4.91E+09
   124:  + PSCBE2	=	1.64E-09	PVAG	=	3.48E+00	DELTA	=	1.00E-02
   125:  + RSH	=	7.69E+00	MOBMOD	=	1.00E+00	PRT	=	0.00E+00
   126:  + UTE	=	-1.49E+00	KT1	=	-1.09E-01	KT1L	=	0.00E+00
   127:  + KT2	=	2.18E-02	UA1	=	4.27E-09	UB1	=	-7.68E-18
   128:  + UC1	=	-5.57E-11	AT	=	3.31E+04	WL	=	0.00E+00
   129:  + WLN	=	1.00E+00	WW	=	0.00E+00	WWN	=	1.00E+00
   130:  + WWL	=	0.00E+00	LL	=	0.00E+00	LLN	=	1.00E+00
   131:  + LW	=	0.00E+00	LWN	=	1.00E+00	LWL	=	0.00E+00
   132:  + CAPMOD	=	2.00E+00	XPART	=	5.00E-01	CGDO	=	6.88E-10
   133:  + CGSO	=	6.85E-10	CGBO	=	1.00E-12	CJ	=	'1.2e-3/proc_delta'
   134:  + PB	=	8.70E-01	MJ	=	4.20E-01	CJSW	=	'2.4e-10/proc_delta'
   135:  + PBSW	=	8.00E-01	MJSW	=	3.57E-01	CJSWG	=	4.24E-10
   136:  + PBSWG	=	8.00E-01	MJSWG	=	3.56E-01	CF	=	0.00E+00
   137:  + PVTH0	=	3.53E-03	PRDSW	=	1.02E+01	PK2	=	3.35E-03
   138:  + WKETA	=	3.52E-02	LKETA	=	-2.06E-03	PU0	=	-2.19E+00
   139:  + PUA	=	-7.63E-11	PUB	=	9.91E-22	PVSAT	=	5.00E+01
   140:  + PKETA	=	-6.41E-03	KF	=	1.29E-29	PETA0	=	7.31E-05
   141:  
   142:  *end of: ./p18_model_card.inc
   143:  *include ./p18_cmos_models_tt.inc
   144:  .param proc_delta = 1.0
   145:  .param vt_shift = 0.0
   146:  *include p18_model_card.inc
   147:  * p18 model card
   148:  .MODEL NMOS NMOS  								
   149:  + VERSION	=	3.1						
   150:  + LEVEL	=	49	NOIMOD	=	1	TNOM	=	2.70E+01
   151:  + TOX	=	'4.1E-9/proc_delta'	XJ	=	1.00E-07	NCH	=	2.33E+17
   152:  + VTH0	=	'0.36+vt_shift'	K1	=	5.84E-01	K2	=	4.14E-03
   153:  + K3	=	1.01E-03	K3B	=	2.20E+00	W0	=	1.00E-07
   154:  + NLX	=	1.81E-07	DVT0W	=	0.00E+00	DVT1W	=	0.00E+00
   155:  + DVT2W	=	0.00E+00	DVT0	=	1.73E+00	DVT1	=	4.38E-01
   156:  + DVT2	=	-3.70E-04	U0	=	'260*proc_delta*proc_delta'	UA	=	-1.38E-09
   157:  + UB	=	2.26E-18	UC	=	5.46E-11	VSAT	=	1.03E+05
   158:  + A0	=	1.92E+00	AGS	=	4.20E-01	B0	=	-1.52E-09
   159:  + B1	=	-9.92E-08	KETA	=	-7.16E-03	A1	=	6.61E-04
   160:  + A2	=	8.89E-01	RDSW	=	1.12E+02	PRWG	=	4.92E-01
   161:  + PRWB	=	-2.02E-01	WR	=	1.00E+00	WINT	=	7.12E-09
   162:  + LINT	=	1.12E-08	XL	=	-2.00E-08	XW	=	-1.00E-08
   163:  + DWG	=	-3.82E-09	DWB	=	8.63E-09	VOFF	=	-8.82E-02
   164:  + NFACTOR	=	2.30E+00	CIT	=	0.00E+00	CDSC	=	2.40E-04
   165:  + CDSCD	=	0.00E+00	CDSCB	=	0.00E+00	ETA0	=	3.13E-03
   166:  + ETAB	=	1.00E+00	DSUB	=	2.25E-02	PCLM	=	7.20E-01
   167:  + PDIBLC1	=	2.15E-01	PDIBLC2	=	2.23E-03	PDIBLCB	=	1.00E-01
   168:  + DROUT	=	8.01E-01	PSCBE1	=	5.44E+08	PSCBE2	=	1.00E-03
   169:  + PVAG	=	1.00E-12	DELTA	=	1.00E-02	RSH	=	6.78E+00
   170:  + MOBMOD	=	1.00E+00	PRT	=	0.00E+00	UTE	=	-1.50E+00
   171:  + KT1	=	-1.10E-01	KT1L	=	0.00E+00	KT2	=	2.19E-02
   172:  + UA1	=	4.28E-09	UB1	=	-7.62E-18	UC1	=	-5.57E-11
   173:  + AT	=	3.30E+04	WL	=	0.00E+00	WLN	=	1.00E+00
   174:  + WW	=	0.00E+00	WWN	=	1.00E+00	WWL	=	0.00E+00
   175:  + LL	=	0.00E+00	LLN	=	1.00E+00	LW	=	0.00E+00
   176:  + LWN	=	1.00E+00	LWL	=	0.00E+00	CAPMOD	=	2.00E+00
   177:  + XPART	=	5.00E-01	CGDO	=	6.98E-10	CGSO	=	7.03E-10
   178:  + CGBO	=	1.00E-12	CJ	=	'9.8e-4/proc_delta'	PB	=	7.34E-01
   179:  + MJ	=	3.63E-01	CJSW	=	'2.4e-10/proc_delta'	PBSW	=	4.71E-01
   180:  + MJSW	=	1.00E-01	CJSWG	=	3.29E-10	PBSWG	=	4.66E-01
   181:  + MJSWG	=	1.00E-01	CF	=	0.00E+00	PVTH0	=	-7.16E-04
   182:  + PRDSW	=	-6.66E-01	PK2	=	5.92E-04	WKETA	=	2.14E-04
   183:  + LKETA	=	-1.51E-02	PU0	=	3.36E+00	PUA	=	-1.31E-11
   184:  + PUB	=	0.00E+00	PVSAT	=	1.25E+03	PETA0	=	1.00E-04
   185:  + PKETA	=	6.45E-04	KF	=	4.46E-29			
   186:  								
   187:  .MODEL PMOS PMOS  								
   188:  + VERSION	=	3.1						
   189:  + LEVEL	=	49	NOIMOD	=	1			
   190:  + TNOM	=	2.70E+01	TOX	=	'4.1E-9/proc_delta'	XJ	=	1.00E-07
   191:  + NCH	=	4.12E+17	VTH0	=	'-0.39-vt_shift'	K1	=	5.50E-01
   192:  + K2	=	3.50E-02	K3	=	0.00E+00	K3B	=	1.20E+01
   193:  + W0	=	1.00E-06	NLX	=	1.25E-07	DVT0W	=	0.00E+00
   194:  + DVT1W	=	0.00E+00	DVT2W	=	0.00E+00	DVT0	=	5.53E-01
   195:  + DVT1	=	2.46E-01	DVT2	=	1.00E-01	U0	=	'110*proc_delta*proc_delta'
   196:  + UA	=	1.44E-09	UB	=	2.29E-21	UC	=	-1.00E-10
   197:  + VSAT	=	1.95E+05	A0	=	1.72E+00	AGS	=	3.80E-01
   198:  + B0	=	5.87E-07	B1	=	1.44E-06	KETA	=	2.21E-02
   199:  + A1	=	4.66E-01	A2	=	3.00E-01	RDSW	=	3.11E+02
   200:  + PRWG	=	5.00E-01	PRWB	=	1.64E-02	WR	=	1.00E+00
   201:  + WINT	=	0.00E+00	LINT	=	2.00E-08	XL	=	-2.00E-08
   202:  + XW	=	-1.00E-08	DWG	=	-3.49E-08	DWB	=	1.22E-09
   203:  + VOFF	=	-9.80E-02	NFACTOR	=	2.00E+00	CIT	=	0.00E+00
   204:  + CDSC	=	2.40E-04	CDSCD	=	0.00E+00	CDSCB	=	0.00E+00
   205:  + ETA0	=	1.12E-03	ETAB	=	-4.79E-04	DSUB	=	1.60E-03
   206:  + PCLM	=	1.50E+00	PDIBLC1	=	3.00E-02	PDIBLC2	=	-1.01E-05
   207:  + PDIBLCB	=	1.00E-01	DROUT	=	1.56E-03	PSCBE1	=	4.91E+09
   208:  + PSCBE2	=	1.64E-09	PVAG	=	3.48E+00	DELTA	=	1.00E-02
   209:  + RSH	=	7.69E+00	MOBMOD	=	1.00E+00	PRT	=	0.00E+00
   210:  + UTE	=	-1.49E+00	KT1	=	-1.09E-01	KT1L	=	0.00E+00
   211:  + KT2	=	2.18E-02	UA1	=	4.27E-09	UB1	=	-7.68E-18
   212:  + UC1	=	-5.57E-11	AT	=	3.31E+04	WL	=	0.00E+00
   213:  + WLN	=	1.00E+00	WW	=	0.00E+00	WWN	=	1.00E+00
   214:  + WWL	=	0.00E+00	LL	=	0.00E+00	LLN	=	1.00E+00
   215:  + LW	=	0.00E+00	LWN	=	1.00E+00	LWL	=	0.00E+00
   216:  + CAPMOD	=	2.00E+00	XPART	=	5.00E-01	CGDO	=	6.88E-10
   217:  + CGSO	=	6.85E-10	CGBO	=	1.00E-12	CJ	=	'1.2e-3/proc_delta'
   218:  + PB	=	8.70E-01	MJ	=	4.20E-01	CJSW	=	'2.4e-10/proc_delta'
   219:  + PBSW	=	8.00E-01	MJSW	=	3.57E-01	CJSWG	=	4.24E-10
   220:  + PBSWG	=	8.00E-01	MJSWG	=	3.56E-01	CF	=	0.00E+00
   221:  + PVTH0	=	3.53E-03	PRDSW	=	1.02E+01	PK2	=	3.35E-03
   222:  + WKETA	=	3.52E-02	LKETA	=	-2.06E-03	PU0	=	-2.19E+00
   223:  + PUA	=	-7.63E-11	PUB	=	9.91E-22	PVSAT	=	5.00E+01
   224:  + PKETA	=	-6.41E-03	KF	=	1.29E-29	PETA0	=	7.31E-05
   225:  
   226:  *end of: p18_model_card.inc
   227:  *end of: ./p18_cmos_models_tt.inc
   228:  
   229:  ! Pixel subcircuit
   230:  ! syntax: XPixel VDD(in) VSS(in) EXPOSE(in) ERASE(in) NRE(in) OUT(out) CAP_VOLTAGE(out) PIXEL(name) PARAM: I_PD=VAL
   231:  *include ./pixel.cir
   232:  ! Pixel cicuit
   233:  ! Inputs: Vdd, Vss, EXPOSE, ERASE, NRE
   234:  ! Output: OUT
   235:  
   236:  .subckt PIXEL Vdd Vss EXPOSE ERASE NRE OUT N2 PARAM: I_PD=750p
   237:  !!!!!!!!!!!!!!!!!!!
   238:  !!!!! Factors !!!!!
   239:  !!!!!!!!!!!!!!!!!!!
   240:  .param  L       = 0.4u  ! Standard gate length
   241:  .param  WL1     = 3     ! M1 NMOS gate width factor
   242:  .param  WL2     = 3     ! M2 NMOS gate width factor
   243:  .param  WL3     = 3     ! M3 PMOS gate width factor, this is also multiplied with convertion from nmos to pmos
   244:  .param  WL4     = 3     ! M4 PMOS gate width factor, this is also multiplied with convertion from nmos to pmos
   245:  
   246:  ! Convertion between NMOS and PMOS
   247:  .param NtoPMOS  = {27 / 7}
   248:  
   249:  ! Size of sampeling capacitor
   250:  .param cs_size  = 2pf
   251:  
   252:  ! Actual lengths
   253:  .param W1   = {WL1 * L}             ! M1, NMOS
   254:  .param W2   = {WL2 * L}             ! M2, NMOS
   255:  .param W3   = {WL3 * L * NtoPMOS}   ! M3, PMOS
   256:  .param W4   = {WL4 * L * NtoPMOS}   ! M4, PMOS
   257:  
   258:  !.param Ipd = {I_PD}
   259:  
   260:  !!!!!!!!!!!!!!!!!!!!!!
   261:  !!!!! Photodiode !!!!!
   262:  !!!!!!!!!!!!!!!!!!!!!!
   263:  XPD Vdd N1 PhotoDiode Ipd={I_PD}
   264:  
   265:  
   266:  !!!!!!!!!!!!!!!!!!
   267:  !!!!! Expose !!!!!
   268:  !!!!!!!!!!!!!!!!!!
   269:  M1 N1 EXPOSE N2 Vss NMOS L=L W=W1
   270:  
   271:  
   272:  !!!!!!!!!!!!!!!!!!!
   273:  !!!!! N2 Node !!!!!
   274:  !!!!!!!!!!!!!!!!!!!
   275:  
   276:  ! Erase part
   277:  M2 N2 ERASE Vss Vss NMOS L=L W=W2
   278:  
   279:  ! Sampleling caps
   280:  CS N2 Vss cs_size
   281:  
   282:  ! M3 Transistor
   283:  M3 Vss N2 N3 Vdd PMOS L=L W=W3
   284:  
   285:  
   286:  !!!!!!!!!!!!!!!!!!!
   287:  !!!!! N3 Node !!!!!
   288:  !!!!!!!!!!!!!!!!!!!
   289:  
   290:  ! Out transistor
   291:  M4 N3 NRE Out Vdd PMOS L=L W=W4
   292:  
   293:  .ends
   294:  *end of: ./pixel.cir
   295:  ! Column capacitor
   296:  ! syntax: XColCpa VDD(in) VSS(in) COLOUT(out) COLCAPS
   297:  *include ./column_caps.cir
   298:  .subckt COLCAPS Vdd Vss Out
   299:  
   300:  ! Transistor sizes
   301:  .param  L       = 0.4u  ! Standard gate length
   302:  .param  WL      = 3     ! M1 NMOS gate width factor
   303:  
   304:  ! Convertion between NMOS and PMOS
   305:  .param NtoPMOS  = {27 / 7}
   306:  
   307:  .param W   = {WL * L * NtoPMOS}   ! Actual width
   308:  
   309:  ! Actual circuit
   310:  MC1 Out Out Vdd Vdd PMOS L=L W=W
   311:  CC1 Out Vss 3pf
   312:  
   313:  .ends
   314:  *end of: ./column_caps.cir
   315:  
   316:  
   317:  !!!!!!!!!!!!!!!!!!!!!!!!!!
   318:  !!!!! Actual Circuit !!!!! 
   319:  !!!!!!!!!!!!!!!!!!!!!!!!!!
   320:  ! Pixels follow matrix format
   321:  XP11 1 0 EXPOSE ERASE NRE_R1 OUT1 OUT_SAMPLED1 PIXEL I_PD=Ipd_11
   322:  XP12 1 0 EXPOSE ERASE NRE_R1 OUT2 OUT_SAMPLED2 PIXEL I_PD=Ipd_12
   323:  XP21 1 0 EXPOSE ERASE NRE_R2 OUT1 OUT_SAMPLED3 PIXEL I_PD=Ipd_21
   324:  XP22 1 0 EXPOSE ERASE NRE_R2 OUT2 OUT_SAMPLED4 PIXEL I_PD=Ipd_22
   325:  
   326:  ! Column caps
   327:  XCC1 1 0 OUT1 COLCAPS
   328:  XCC2 1 0 OUT2 COLCAPS
   329:  
   330:  
   331:  !!!!!!!!!!!!!!!!!!!!
   332:  !!!!! Analysis !!!!!
   333:  !!!!!!!!!!!!!!!!!!!!
   334:  ! Do a transient analysis
   335:  .tran 5u SIM_TIME 0 10u
   336:  
   337:  ! Plot the voltages
   338:  .plot V(OUT1) V(OUT2) ! signals going to ADC
   339:  .plot V(EXPOSE) V(NRE_R1) V(NRE_R2) V(ERASE)
   340:  .plot V(OUT_SAMPLED1) V(OUT_SAMPLED2) V(OUT_SAMPLED3) V(OUT_SAMPLED4)


******************************  Simulation Statistics  ******************************

	Total number of iterations.....................: 2935
	Number of iterations for transient analysis....: 2911
	Total number of timepoints.....................: 1329
	Number of timepoints accepted..................: 1302
	Number of timepoints rejected..................: 27
	Total analysis time (sec)......................: 0.094
	Transient analysis time (sec)..................: 0.093
	Time spent in device loading (sec).............: 0.06
	Time spent in L-U decomposition (sec)..........: 0.009
	Time spent in matrix reordering (sec)..........: 0
	Time spent in matrix solving (sec).............: 0.005
	Time spent in transient L-U decomposition (sec): 0.009
	Time spent in transient matrix solving (sec)...: 0.005


********************************  Kernel Messages  **********************************

Circuit: * This is a parametrized testbench for your pixel circuit array

Warning: premature EOF
Warning: premature EOF
Warning: premature EOF
Warning: parameter xl not supported; value ignored
Warning: parameter xw not supported; value ignored
Warning: parameter xl not supported; value ignored
Warning: parameter xw not supported; value ignored
Warning: Pd = 0 is less than W for m:cc2:c1 in model pmos.
Warning: Ps = 0 is less than W for m:cc2:c1 in model pmos.
Warning: Pd = 0 is less than W for m:p22:2 in model nmos.
Warning: Ps = 0 is less than W for m:p22:2 in model nmos.

